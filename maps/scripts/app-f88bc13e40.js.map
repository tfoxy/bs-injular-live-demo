{"version":3,"sources":["/source/deps/EventEmitter/EventEmitter.module.js","scripts/app.js"],"names":["angular","module","serverRouterFactory","match","fileChanger","fileSystem","project","getFile","url","file","copy","content","injSettings","settings","injular","templates","wrapTemplate","directives","wrapDirectiveFile","moduleFile","appendProvideGetter","ngApp","angularFile","appendAngularModulePatch","getFileContent","serverRouter","getBlobUrl","blobUrl","_blobUrlCache","get","blob","type","Blob","URL","createObjectURL","set","removeFileCache","name","revokeObjectURL","renameFileCache","newFile","oldFile","Map","events","on","$inject","factory","run","editor","liveDemo","projectCreatorFactory","$http","$log","blank","origin","startLoading","createFile","doneLoading","githubGist","id","then","response","files","data","fileName","errResponse","error","projectCreator","projectFactory","EventEmitter","fileChangeListener","PROJECT_SETTINGS_FILENAME","emitEvent","JSON","parse","filePredeleteListener","loading","Error","clear","resetSettings","autoAddSettingsFile","hasFile","SETTINGS_FILENAME","entryFile","controllers","filters","fileOrder","stringify","[object Object]","liveDemoFactory","$window","setIframe","$iframe","_this","this","_injular","_window","contentWindow","_replaceDocument","reload","document","body","textContent","location","replace","_reloadFn","fileModifiedListener","injectTemplate","template","templateUrl","reloadRoute","reloadRouteOnTemplateInjection","avoidCleanScope","logLevel","recipes","getNgRecipes","length","injectScript","script","scriptUrl","win","doc","open","newInstance","___setUpSinonFakeRequest","getSetUpSinonFakeRequestFn","html","getDocumentHtmlString","write","close","observerDomMutation","push","initialHtml","htmlToDom","modifyDocumentScriptsSrc","modifyDocumentLinksHref","modifyDocumentImgsSrc","prependSinonFakeRequest","getDoctypeHtml","documentElement","outerHTML","err","implementation","createHTMLDocument","scripts","i","src","startsWith","domain","getAttribute","srcPath","slice","setAttribute","newScript","createElement","text","parentNode","insertBefore","nextSibling","links","getElementsByTagName","link","href","String","prototype","call","path","imgs","img","blobifyImgSrc","_noRequests","sinonFilterScriptElement","head","firstChild","sinonScriptElement","callback","mutations","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","mutation","value","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","addedNodes","node","tw","createTreeWalker","NodeFilter","SHOW_ELEMENT","tagName","FILTER_ACCEPT","FILTER_SKIP","nextNode","attributeName","target","observeCreateElement","el","apply","arguments","observer","observe","config","MutationObserver","attributes","childList","subtree","setUpSinonFakeRequest","filter","method","getLocalFileFromUrl","respondWith","xhr","headers","localFile","respond","anchor","server","sinon","fakeServer","create","useFilters","addFilter","autoRespond","removeChild","doctype","publicId","systemId","protocol","host","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Array","isArray","Object","TypeError","editorFactory","$timeout","ace","fileContentChanged","saveFileChanges","fileSet","values","setFile","fileMap","modifyFile","timeoutName","delay","endsWith","delayedAutoSaveFileSet","delayedAutoSaveDelay","instantAutoSaveFileSet","instantAutoSaveDelay","cancel","timeouts","add","aceChangeListener","change","addFile","fsFile","createRawFile","createAceFile","fileList","reorderFileList","changeActiveFile","mode","aceModelist","getModeForPath","createEditSession","defineProperty","getValue","val","setValue","disableEditorWarnings","annotations","getAnnotations","len","test","splice","setAnnotations","renameFile","newName","oldName","setMode","put","deleteFile","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","entries","_step3$value","index","firstFile","projectSettingsModifiedListener","projectInitListener","sort","left","right","leftIndex","indexOf","rightIndex","order","prevFile","activeFile","require","autoSave","Set","delayedAutoSave","instantAutoSave","getFiles","fileSystemFactory","MemoryFile","has","freeze","readFile","getFileType","rename","keys","MemoryFileFactory","createNativeFile","mimeType","lookup","lastModified","liveDemoIframeDirective","scope","element","$on","restrict","directive","addMovingSplitbarClassDirective","attrs","uiLayoutCtrl","processSplitbarAlt","container","movingSplitbar","$addClass","addClass","processSplitbar","mouseUpHandlerAlt","event","removeClass","$removeClass","mouseUpHandler","aceModelManagerDirective","postLink","$scope","$element","$attrs","postEditorActiveFileChangeListener","newSession","acee","setSession","focus","destroyListener","off","edit","window","$blockScrolling","Infinity","$eval","aceModelManagerOnLoad","$acee","EditorViewController","FileReader","activate","outerWidth","mobileMaxWidth","uiLayout","dividerSize","$ctrl","hideOutputMode","collapsed","liveView","aceEditorLoadListener","setEditorCommands","commands","addCommands","saveFile","bindKey","mac","sender","exec","$apply","showNewFilePrompt","newFileName","prompt","showRenameFilePrompt","toggleEditorCollapse","previousCollapsedFileListStatus","importFiles","_loop","extension","counter","readAsText","isStringBinary","console","string","removeFile","removeConfirmed","confirm","flow","disableToggle","extend","component","controller","routerConfig","$urlRouterProvider","$stateProvider","otherwise","state","abstract","resolve","__init__","$stateParams","gistId","$logProvider","debugEnabled","hostname","extensionIndex","lastIndexOf","_dict","mimeTypes","bmp","css","gif","ico","jpe","jpeg","jpg","js","json","png","svg","tiff","webp","xml","constant","pattern","minimatch","parts","filename","properties","File","date","Date","lastModifiedDate","$templateCache"],"mappings":"AAAA,cAEA,WAGEA,QAAQC,OAAO,2CAA4C,mCAAoC,qCAAsC,wCAAyC,0CAMhL,WAKE,QAASC,GAAoBC,EAAOC,EAAaC,EAAYC,GAgB3D,QAASC,GAAQC,GACf,GAAIC,GAAOJ,EAAWE,QAAQC,GAAKE,MACnC,IAAID,EAAKA,KAAM,MAAOA,EACtB,IAAIE,GAAUF,EAAKE,QACfC,EAAcN,EAAQO,SAASC,OAWnC,OAVIX,GAAMK,EAAKI,EAAYG,WACzBJ,EAAUP,EAAYY,aAAaL,EAASH,GACnCL,EAAMK,EAAKI,EAAYK,YAChCN,EAAUP,EAAYc,kBAAkBP,EAASH,GACxCL,EAAMK,EAAKI,EAAYO,YAChCR,EAAUP,EAAYgB,oBAAoBT,EAASC,EAAYS,OACtDlB,EAAMK,EAAKI,EAAYU,eAChCX,EAAUP,EAAYmB,yBAAyBZ,IAEjDF,EAAKE,QAAUA,EACRF,EAGT,QAASe,GAAehB,GACtB,MAAOiB,GAAalB,QAAQC,GAAKG,QAGnC,QAASe,GAAWlB,GAClB,GAAImB,GAAUC,EAAcC,IAAIrB,EAChC,KAAKmB,EAAS,CACZ,GAAIlB,GAAOgB,EAAalB,QAAQC,GAC5BsB,EAAO,MACX,IAAIrB,EAAKA,KACPqB,EAAOrB,EAAKA,SACP,CACL,GAAIE,GAAUF,EAAKE,QACfoB,EAAOtB,EAAKsB,IAChBD,GAAO,GAAIE,OAAMrB,IAAYoB,KAAMA,IAErCJ,EAAUM,IAAIC,gBAAgBJ,GAC9BF,EAAcO,IAAI3B,EAAKmB,GAEzB,MAAOA,GAGT,QAASS,GAAgB3B,GACvB,GAAIkB,GAAUC,EAAcC,IAAIpB,EAAK4B,KACjCV,KACFM,IAAIK,gBAAgBX,GACpBC,EAAAA,UAAqBnB,EAAK4B,OAI9B,QAASE,GAAgBC,EAASC,GAChCL,EAAgBK,GAChBhB,EAAaC,WAAWc,EAAQH,MAjElC,GAAIT,GAAgB,GAAIc,KAEpBjB,GACFG,cAAeA,EACfF,WAAYA,EACZnB,QAASA,EACTiB,eAAgBA,EAOlB,OAJAnB,GAAWsC,OAAOC,GAAG,aAAcR,GACnC/B,EAAWsC,OAAOC,GAAG,aAAcL,GACnClC,EAAWsC,OAAOC,GAAG,aAAcR,GAE5BX,EChBTvB,EAAoB2C,SAAW,QAAS,cAAe,aAAc,WDArE7C,QAAQC,OAAO,2CAA2C6C,QAAQ,eAAgB5C,MA4EpF,WAGEF,QAAQC,OAAO,6CAA8C,qCAAsC,wCAGnG,oCAAqC,0CAA2C,wCAE/E8C,KAAA,SAAA,eAAA,WAAI,SAAUC,EAAQvB,EAAcwB,UAOvC,WAKE,QAASC,GAAsBC,EAAOC,EAAM9C,EAASD,GAQnD,QAASgD,KACP,GAAIC,GAAS,OACThD,GAAQgD,SAAWA,IACvBhD,EAAQgD,OAASA,EACjBhD,EAAQiD,eACRlD,EAAWmD,WAAW,aAAc,sRACpClD,EAAQmD,eAGV,QAASC,GAAWC,GAClB,GAAIL,GAAS,WAAaK,CAC1B,IAAIrD,EAAQgD,SAAWA,EAGvB,MAFAhD,GAAQgD,OAASA,EACjBhD,EAAQiD,eACDJ,EAAMtB,IAAI,gCAAkC8B,GAAIC,KAAK,SAAUC,GACpE,GAAIC,GAAQD,EAASE,KAAKD,KAC1B,KAAK,GAAIE,KAAYF,GAAO,CAC1B,GAAIrD,GAAOqD,EAAME,EACjB3D,GAAWmD,WAAWQ,EAAUvD,EAAKE,QAASF,EAAKsB,MAErDzB,EAAQmD,eACP,SAAUQ,GACXb,EAAKc,MAAMD,KA7Bf,GAAIE,IACFd,MAAOA,EACPK,WAAYA,EAGd,OAAOS,GCPTjB,EAAsBL,SAAW,QAAS,OAAQ,UAAW,cDD7D7C,QAAQC,OAAO,6CAA6C6C,QAAQ,iBAAkBI,MAyCxF,WAGElD,QAAQC,OAAO,sCAAuC,sCAAuC,6CAM/F,WAOE,QAASmE,GAAeC,EAAchE,GAoBpC,QAASiE,GAAmB7D,GACtBA,EAAK4B,OAASkC,IAChBjE,EAAQqC,OAAO6B,UAAU,qBACzBlE,EAAQO,SAAW4D,KAAKC,MAAMjE,EAAKE,SAC9BL,EAAQO,SAASC,UACpBR,EAAQO,SAASC,YAEnBR,EAAQqC,OAAO6B,UAAU,uBAI7B,QAASG,GAAsBnC,EAASC,GACtC,GAAIhC,GAAOgC,GAAWD,CACtB,IAAI/B,EAAK4B,OAASkC,IAA8BjE,EAAQsE,QACtD,KAAM,IAAIC,OAAMN,EAA4B,2BAIhD,QAAShB,KACPjD,EAAQsE,SAAU,EAClBvE,EAAWyE,QACXC,IAGF,QAAStB,KACPuB,IACA1E,EAAQsE,SAAU,EAClBtE,EAAQqC,OAAO6B,UAAU,QAG3B,QAASO,KACPzE,EAAQO,UAAaC,YAGvB,QAASkE,KACP,IAAK3E,EAAW4E,QAAQ3E,EAAQ4E,mBAAoB,CAClD,GAAIrE,IACFsE,UAAW,aACXrE,SACEC,UAAW,mBACXqE,YAAa,yBACbnE,WAAY,yCACZoE,QAAS,qBACT/D,YAAa,uBACbH,WAAY,gCAEdmE,WAAY,kBAEV3E,EAAU8D,KAAKc,UAAU1E,EAAU,KAAM,EAC7CR,GAAWmD,WAAWlD,EAAQ4E,kBAAmBvE,IApErD,GAAIL,IACFkF,GAAIN,qBACF,MAAOX,IAETjB,OAAQ,KACRsB,SAAS,EACTrB,aAAcA,EACdE,YAAaA,EACbd,OAAQ,GAAI0B,GASd,OAPAU,KAEA1E,EAAWsC,OAAOC,GAAG,aAAc0B,GACnCjE,EAAWsC,OAAOC,GAAG,aAAc0B,GACnCjE,EAAWsC,OAAOC,GAAG,YAAa+B,GAClCtE,EAAWsC,OAAOC,GAAG,YAAa+B,GAE3BrE,ECpBT8D,EAAevB,SAAW,eAAgB,aDF1C,IAAI0B,GAA4B,eAEhCvE,SAAQC,OAAO,sCAAsC6C,QAAQ,UAAWsB,MAgF1E,WAGEpE,QAAQC,OAAO,uCAAwC,sCAAuC,mCAAoC,iCAAkC,qCAAsC,wCAAyC,0CAA2C,0CAMhS,WAKE,QAASwF,GAAgBrC,EAAMsC,EAASrB,EAAclE,EAAOW,EAASV,EAAaC,EAAYoB,EAAcnB,GAoB3G,QAASqF,GAAUC,GACjB,GAAIC,GAAQC,IAEZ,IAAIA,KAAKF,UAAYA,IACrBE,KAAKF,QAAUA,EACfE,KAAKC,SAAW,KAChBD,KAAKE,QAAU,KACVJ,GAAL,CAEA,GADAE,KAAKE,QAAUJ,EAAQ,GAAGK,eACrBH,KAAKE,QACR,KAAM,IAAInB,OAAM,gCAElBiB,MAAKF,QAAQhD,GAAG,OAAQ,WAClBgD,IAAYC,EAAMD,UACpBC,EAAMG,QAAUH,EAAMD,QAAQ,GAAGK,cACjCJ,EAAMK,uBAKZ,QAASC,KACFL,KAAKE,UACN1F,EAAQsE,QACVkB,KAAKE,QAAQI,SAASC,KAAKC,YAAc,cAEzCR,KAAKE,QAAQO,SAASC,QAAQ,eAC9BV,KAAKC,SAAW,OAIpB,QAASU,KACPxD,EAASkD,SAGX,QAASO,GAAqBjG,GAC5B,GAAII,GAAWP,EAAQO,QACvB,IAAKoC,EAAS8C,SAEP,GAAI5F,EAAMM,EAAK4B,KAAMxB,EAASC,QAAQC,WAAY,CACvD,GAAIJ,GAAUc,EAAaD,eAAef,EAAK4B,KAC/CY,GAAS8C,SAASY,gBAChBC,SAAUjG,EACVkG,YAAapG,EAAK4B,KAClByE,YAAajG,EAASC,QAAQiG,+BAC9BC,gBAAiBnG,EAASC,QAAQkG,gBAClCC,SAAUpG,EAASoG,eAEhB,CACL,GAAIC,GAAUC,EAAa1G,EAAK4B,KAC5B6E,GAAQE,OACVnE,EAAS8C,SAASsB,cAChBC,OAAQ7G,EAAKE,QACb4G,UAAW9G,EAAK4B,KAChB6E,QAASA,EACTD,SAAUpG,EAASoG,WAGrBhE,EAASkD,aApBXlD,GAASkD,SAyBb,QAASD,KACP,GAAI5F,EAAQO,SAASsE,UAAW,CAC9B,GAAIqC,GAAM1B,KAAKE,QACXyB,EAAMD,EAAIpB,SAASsB,MACvB5B,MAAKnD,OAAO6B,UAAU,sBACtB1D,EAAQ6G,YAAYH,EAAKC,GACzB3B,KAAKC,SAAWyB,EAAI1G,cACb0G,GAAI1G,QACX0G,EAAII,yBAA2BC,EAA2BL,EAC1D,IAAIM,GAAOC,GACXN,GAAIO,MAAMF,GACVL,EAAIQ,QACJC,EAAoBT,GACpB3B,KAAKnD,OAAO6B,UAAU,wBAI1B,QAAS2C,GAAa9E,GACpB,GAAIzB,GAAcN,EAAQO,SAASC,QAC/BoG,IAQJ,OAPI/G,GAAMkC,EAAMzB,EAAYwE,aAC1B8B,EAAQiB,KAAK,cACJhI,EAAMkC,EAAMzB,EAAYK,YACjCiG,EAAQiB,KAAK,aACJhI,EAAMkC,EAAMzB,EAAYyE,UACjC6B,EAAQiB,KAAK,UAERjB,EAGT,QAASa,KACP,GAAI5C,GAAY7E,EAAQO,SAASsE,SACjC,KACE,GAAIiD,GAAc3G,EAAaD,eAAe2D,GAC1CsC,EAAMY,EAAUD,EAKpB,OAJAE,GAAyBb,GACzBc,EAAwBd,GACxBe,EAAsBf,GACtBgB,EAAwBhB,GACjBiB,EAAejB,GAAOA,EAAIkB,gBAAgBC,UACjD,MAAOC,GAEP,MADAzF,GAAKc,MAAM2E,GACJ,wBAA0BA,EAAM,QAI3C,QAASR,GAAU1H,GACjB,GAAI8G,GAAMrB,SAAS0C,eAAeC,oBAIlC,OAHAtB,GAAIC,OACJD,EAAIO,MAAM,oBAAsBrH,GAChC8G,EAAIQ,QACGR,EAGT,QAASa,GAAyBb,GAEhC,IAAK,GADDuB,GAAUvB,EAAIuB,QACTC,EAAI,EAAGA,EAAID,EAAQ5B,OAAQ6B,IAAK,CACvC,GAAI3B,GAAS0B,EAAQC,GACjBC,EAAM5B,EAAO4B,GACjB,IAAIA,EAAIC,WAAWC,IAAW9B,EAAO+B,aAAa,OAAQ,CACxD,GAAIC,GAAUJ,EAAIK,MAAMH,EAAOhC,OAAS,GACpCzF,EAAUF,EAAaC,WAAW4H,EACtChC,GAAOkC,aAAa,cAAeN,GACnC5B,EAAOkC,aAAa,MAAO7H,OACtB,IAAIxB,EAAM+I,EAAK5I,EAAQO,SAASC,QAAQQ,aAAc,CAC3D,GAAImI,GAAYhC,EAAIiC,cAAc,SAClCD,GAAUE,KAAOvJ,EAAYmB,yBAAyB,IACtD+F,EAAOsC,WAAWC,aAAaJ,EAAWnC,EAAOwC,eAKvD,QAASvB,GAAwBd,GAE/B,IAAK,GADDsC,GAAQtC,EAAIuC,qBAAqB,QAC5Bf,EAAI,EAAGA,EAAIc,EAAM3C,OAAQ6B,IAAK,CACrC,GAAIgB,GAAOF,EAAMd,GACbiB,EAAOD,EAAKC,IAChB,IAAIC,OAAOC,UAAUjB,WAAWkB,KAAKH,EAAMd,GAAS,CAClD,GAAIkB,GAAOJ,EAAKX,MAAMH,EAAOhC,OACzBkD,GAAKnB,WAAW,OAClBmB,EAAOA,EAAKf,MAAM,GAEpB,IAAI5H,GAAUF,EAAaC,WAAW4I,EACtCL,GAAKT,aAAa,OAAQ7H,KAKhC,QAAS6G,GAAsBf,GAE7B,IAAK,GADD8C,GAAO9C,EAAIuC,qBAAqB,OAC3Bf,EAAI,EAAGA,EAAIsB,EAAKnD,OAAQ6B,IAAK,CACpC,GAAIuB,GAAMD,EAAKtB,EACfwB,GAAcD,IAIlB,QAAS/B,GAAwBhB,GAC/B,IAAIxE,EAASyH,YAAb,CACA,GAAIC,GAA2BlD,EAAIiC,cAAc,SACjDiB,GAAyBhB,KAAO,gGAChClC,EAAImD,KAAKf,aAAac,EAA0BlD,EAAImD,KAAKC,WAEzD,IAAIC,GAAqBrD,EAAIiC,cAAc,SAC3CoB,GAAmBtB,aAAa,MAAO,iCACvC/B,EAAImD,KAAKf,aAAaiB,EAAoBrD,EAAImD,KAAKC,aAGrD,QAAS3C,GAAoBT,GAS3B,QAASsD,GAASC,GAChB,GAAIC,IAA4B,EAC5BC,GAAoB,EACpBC,EAAiBC,MAErB,KACE,IAAK,GAA8CC,GAA1CC,EAAYN,EAAUO,OAAOC,cAAsBP,GAA6BI,EAAQC,EAAUG,QAAQC,MAAOT,GAA4B,EAAM,CAC1J,GAAIU,GAAWN,EAAMO,MACjBC,GAA6B,EAC7BC,GAAqB,EACrBC,EAAkBX,MAEtB,KACE,IAAK,GAAyDY,GAArDC,EAAaN,EAASO,WAAWX,OAAOC,cAAuBK,GAA8BG,EAASC,EAAWR,QAAQC,MAAOG,GAA6B,EAAM,CAC1K,GAAIM,GAAOH,EAAOJ,KAElBnB,GAAc0B,EAOd,KANA,GAAIC,GAAKhG,SAASiG,iBAAiBF,EAAMG,WAAWC,aAAc,SAAUJ,GAC1E,MAAqB,QAAjBA,EAAKK,QACAF,WAAWG,cAEbH,WAAWI,cAEbP,EAAOC,EAAGO,YACflC,EAAc0B,IAGlB,MAAOtD,GACPiD,GAAqB,EACrBC,EAAkBlD,ECKlB,QDHA,KACOgD,GAA8BI,EAAAA,WACjCA,EAAAA,YCMF,QDHA,GAAIH,EACF,KAAMC,IAKmB,QAA3BJ,EAASiB,eACXnC,EAAckB,EAASkB,SAG3B,MAAOhE,GACPqC,GAAoB,EACpBC,EAAiBtC,ECKjB,QDHA,KACOoC,GAA6BK,EAAAA,WAChCA,EAAAA,YCMF,QDHA,GAAIJ,EACF,KAAMC,KAMd,QAAS2B,KACP,GAAIC,GAAKrD,EAAcsD,MAAMlH,KAAMmH,UAEnC,OADAC,GAASC,QAAQJ,EAAIK,GACdL,EAzET,GAAgC,mBAArBM,kBAAX,CACA,GAAIH,GAAW,GAAIG,kBAAiBtC,GAChCqC,GAAWE,YAAY,EAAMC,WAAW,EAAMC,SAAS,EAC3DN,GAASC,QAAQ1F,EAAK2F,EAEtB,IAAI1D,GAAgBjC,EAAIiC,aACxBjC,GAAIiC,cAAgBoD,GAuEtB,QAASrC,GAAc0B,GACrB,GAAIjD,GAAMiD,EAAKjD,KAAO,EACtB,IAAIiB,OAAOC,UAAUjB,WAAWkB,KAAKnB,EAAKE,GAAS,CACjD,GAAIkB,GAAOpB,EAAIK,MAAMH,EAAOhC,OACxBkD,GAAKnB,WAAW,OAClBmB,EAAOA,EAAKf,MAAM,GAEpB,IAAI5H,GAAUF,EAAaC,WAAW4I,EACtC6B,GAAK3C,aAAa,MAAO7H,GACzBwK,EAAK3C,aAAa,cAAeN,IAIrC,QAASrB,GAA2BL,GAGlC,QAASiG,KAWP,QAASC,GAAOC,EAAQnN,GACtB,IAEE,MADAoN,GAAoBpN,IACb,EACP,MAAOqI,GACP,OAAO,GAIX,QAASgF,GAAYC,GACnB,GAAIC,MACAC,EAAYJ,EAAoBE,EAAItN,IACpCwN,GAAUjM,OACZgM,EAAQ,gBAAkBC,EAAUjM,MAEtC+L,EAAIG,QAAQ,IAAKF,EAASC,EAAUrN,SAGtC,QAASiN,GAAoBpN,GAC3B0N,EAAOhE,KAAO1J,CACd,IAAI0J,GAAOgE,EAAOhE,IAClB,IAAIA,EAAKf,WAAWC,GAAS,CAC3B,GAAIpF,GAAWkG,EAAKX,MAAMH,EAAOhC,OAAS,EAC1C,OAAO3F,GAAalB,QAAQyD,IAjChC,GAAIkK,GAAS1G,EAAIpB,SAASsD,cAAc,KACpCyE,EAAS3G,EAAI4G,MAAMC,WAAWC,QAClCH,GAAOL,IAAIS,YAAa,EACxBJ,EAAOL,IAAIU,UAAUd,GACrBS,EAAON,YAAYA,GACnBM,EAAOM,aAAc,CACrB,IAAIzF,GAAUxB,EAAIpB,SAAS4C,OAC3BxB,GAAIpB,SAASwE,KAAK8D,YAAY1F,EAAQ,IACtCxB,EAAIpB,SAASwE,KAAK8D,YAAY1F,EAAQ,IAXxC,MAAOyE,GA0CT,QAAS/E,GAAejB,GACtB,GAAI0E,GAAO1E,EAAIkH,OACf,OAAKxC,GACE,aAAeA,EAAK9J,MAAQ8J,EAAKyC,SAAW,YAAczC,EAAKyC,SAAW,IAAM,MAAQzC,EAAKyC,UAAYzC,EAAK0C,SAAW,UAAY,KAAO1C,EAAK0C,SAAW,KAAO1C,EAAK0C,SAAW,IAAM,IAAM,MADpL,GApUpB,GAAIzF,GAAS1D,EAAQa,SAASuI,SAAW,KAAOpJ,EAAQa,SAASwI,KAE7D9L,GACFN,OAAQ,GAAI0B,GACZsB,UAAWA,EACXQ,OAAQA,EACRD,iBAAkBA,EAWpB,OARA7F,GAAWsC,OAAOC,GAAG,aAAc8D,GACnCrG,EAAWsC,OAAOC,GAAG,aAAc8D,GACnCrG,EAAWsC,OAAOC,GAAG,aAAc8D,GACnCrG,EAAWsC,OAAOC,GAAG,aAAc6D,GAEnCnG,EAAQqC,OAAOC,GAAG,OAAQ6D,GAC1BnG,EAAQqC,OAAOC,GAAG,qBAAsB6D,GAEjCxD,ECjBTwC,EAAgB5C,SAAW,OAAQ,UAAW,eAAgB,QAAS,UAAW,cAAe,aAAc,eAAgB,WDH/H7C,QAAQC,OAAO,uCAAuC6C,QAAQ,WAAY2C,MAgV5E,WAGEzF,QAAQC,OAAO,qCAAsC,sCAAuC,6BAA8B,wCAAyC,yCAMrK,IAAI+O,gBAAiB,WAAc,QAASC,GAAcC,EAAKjG,GAAK,GAAIkG,MAAeC,GAAK,EAAUC,GAAK,EAAWC,EAAKlE,MAAW,KAAM,IAAK,GAAiCmE,GAA7BC,EAAKN,EAAI3D,OAAOC,cAAmB4D,GAAMG,EAAKC,EAAG/D,QAAQC,QAAoByD,EAAKhH,KAAKoH,EAAG3D,QAAY3C,GAAKkG,EAAK/H,SAAW6B,GAA3DmG,GAAK,IAAoE,MAAOvG,GAAOwG,GAAK,EAAMC,EAAKzG,EAAA,QAAiB,KAAWuG,GAAMI,EAAG,WAAWA,EAAG,YAAA,QAAyB,GAAIH,EAAI,KAAMC,IAAQ,MAAOH,GAAQ,MAAO,UAAUD,EAAKjG,GAAK,GAAIwG,MAAMC,QAAQR,GAAQ,MAAOA,EAAY,IAAI3D,OAAOC,WAAYmE,QAAOT,GAAQ,MAAOD,GAAcC,EAAKjG,EAAa,MAAM,IAAI2G,WAAU,6DAEtlB,WAKE,QAASC,GAAcC,EAAUzL,EAAc0L,EAAK1P,EAAYC,GA6D9D,QAAS0P,GAAmBvP,GAkB1B,QAASwP,KACP,GAAIpE,IAA6B,EAC7BC,GAAqB,EACrBC,EAAkBX,MAEtB,KACE,IAAK,GAAsDY,GAAlDC,EAAaiE,EAAQC,SAAS5E,OAAOC,cAAuBK,GAA8BG,EAASC,EAAWR,QAAQC,MAAOG,GAA6B,EAAM,CACvK,GAAI7H,GAAWgI,EAAOJ,MAElBwE,EAAUC,EAAQxO,IAAImC,EAC1B3D,GAAWiQ,WAAWF,EAAQ/N,KAAM+N,EAAQzP,UAE9C,MAAOkI,GACPiD,GAAqB,EACrBC,EAAkBlD,ECMlB,QDJA,KACOgD,GAA8BI,EAAAA,WACjCA,EAAAA,YCOF,QDJA,GAAIH,EACF,KAAMC,IAKZmE,EAAQpL,QA5CV,GAAIoL,GAAU,OACVK,EAAc,OACdC,EAAQ,OACRnO,EAAO5B,EAAK4B,IACZA,GAAKoO,SAAS,QAAUpO,IAAS/B,EAAQ4E,mBAAqB7C,IAAS/B,EAAQO,SAASsE,WAC1F+K,EAAUQ,EACVH,EAAc,kBACdC,EAAQ3P,EAAS8P,uBAEjBT,EAAUU,EACVL,EAAc,kBACdC,EAAQ3P,EAASgQ,sBAEnBf,EAASgB,OAAOC,EAASR,IACzBL,EAAQc,IAAI3O,GACZ0O,EAASR,GAAeT,EAASG,EAAiBO,GAiCpD,QAASS,GAAkBC,EAAQzQ,GACjCuP,EAAmBvP,GAGrB,QAAS0Q,GAAQC,GACf,GAAI3Q,GAAO,MAETA,GADE2Q,EAAO3Q,KACF4Q,EAAcD,GAEdE,EAAcF,GAEvBf,EAAQlO,IAAI1B,EAAK4B,KAAM5B,GACvB8Q,EAASpJ,KAAK1H,GACd+Q,IACAxO,EAAOyO,iBAAiBhR,EAAK4B,MAG/B,QAASiP,GAAcF,GACrB,GAAIM,GAAOC,EAAYC,eAAeR,EAAO/O,MAAMqP,KAC/CjR,EAAOsP,EAAI8B,kBAAkBT,EAAOzQ,QAAS+Q,EAYjD,OAXAjR,GAAK4B,KAAO+O,EAAO/O,KACnBsN,OAAOmC,eAAerR,EAAM,WAC1BoB,IAAK,WACH,MAAOpB,GAAKgH,IAAIsK,YAElB5P,IAAK,SAAa6P,GAChB,MAAOvR,GAAKgH,IAAIwK,SAASD,MAG7BE,EAAsBzR,GACtBA,EAAKmC,GAAG,SAAUqO,GACXxQ,EAGT,QAAS4Q,GAAcD,GACrB,MAAOA,GAAO1Q,OAGhB,QAASwR,GAAsBzR,GAC7BA,EAAKmC,GAAG,mBAAoB,WAC1B,GAAInC,EAAK4B,KAAKoO,SAAS,UAAYhQ,EAAK4B,OAAS/B,EAAQO,SAASsE,UAAW,CAI3E,IAHA,GAAIgN,GAAc1R,EAAK2R,iBACnBC,EAAMF,EAAY/K,OAClB6B,EAAIoJ,EACDpJ,KACD,2BAA2BqJ,KAAKH,EAAYlJ,GAAGU,OACjDwI,EAAYI,OAAOtJ,EAAG,EAGtBkJ,GAAY/K,OAASiL,GACvB5R,EAAK+R,eAAeL,MAS5B,QAASM,GAAWjQ,EAASC,GAC3B,GAAIiQ,GAAUlQ,EAAQH,KAClBsQ,EAAUlQ,EAAQJ,KAClB5B,EAAO4P,EAAQxO,IAAI8Q,EACvBtC,GAAAA,UAAesC,GACflS,EAAK4B,KAAOqQ,CACZ,IAAIhB,GAAOC,EAAYC,eAAec,GAAShB,IAC/CjR,GAAKmS,QAAQlB,GACbrB,EAAQlO,IAAI1B,EAAK4B,KAAM5B,GACvB+Q,IAEId,EAAAA,UAA8BiC,IAChCjC,EAAuBmC,IAAIH,GAEzB9B,EAAAA,UAA8B+B,IAChC/B,EAAuBiC,IAAIH,GAI/B,QAASI,GAAW1B,GAClBf,EAAAA,UAAee,EAAO/O,KACtB,IAAI0Q,IAA6B,EAC7BC,GAAqB,EACrBC,EAAkB7H,MAEtB,KACE,IAAK,GAAwD8H,GAApDC,EAAa5B,EAAS6B,UAAU7H,OAAOC,cAAuBuH,GAA8BG,EAASC,EAAW1H,QAAQC,MAAOqH,GAA6B,EAAM,CACzK,GAAIM,GAAerE,eAAekE,EAAOtH,MAAO,GAE5C0H,EAAQD,EAAa,GACrB5S,EAAO4S,EAAa,EAEpB5S,GAAK4B,OAAS+O,EAAO/O,OACvBkP,EAASgB,OAAOe,EAAO,GACvB5C,EAAAA,UAA8BjQ,EAAK4B,MACnCuO,EAAAA,UAA8BnQ,EAAK4B,QAGvC,MAAOwG,GACPmK,GAAqB,EACrBC,EAAkBpK,ECMlB,QDJA,KACOkK,GAA8BI,EAAAA,WACjCA,EAAAA,YCOF,QDJA,GAAIH,EACF,KAAMC,IAKZ,GAAIM,GAAYvQ,EAAOuO,SAAS,EAChCvO,GAAOyO,iBAAiB8B,EAAYA,EAAUlR,KAAO,MAGvD,QAASmR,KACPhC,IAGF,QAASiC,KACP,GAAIF,GAAYvQ,EAAOuO,SAAS,EAChCvO,GAAOyO,iBAAiB8B,EAAYA,EAAUlR,KAAO,MAGvD,QAASmP,KACP,GAAIlM,GAAYhF,EAAQO,SAASyE,aACjCiM,GAASmC,KAAK,SAAUC,EAAMC,GAC5B,GAAIC,GAAYvO,EAAUwO,QAAQH,EAAKtR,MACnC0R,EAAazO,EAAUwO,QAAQF,EAAMvR,KACzB,GAAZwR,IAAeA,EAAYvO,EAAU8B,QACxB,EAAb2M,IAAgBA,EAAazO,EAAU8B,OAC3C,IAAI4M,GAAQH,EAAYE,CAIxB,OAHc,KAAVC,IACFA,EAAQL,EAAKtR,MAAQuR,EAAMvR,KAAO,GAAK,GAElC2R,IAIX,QAASvC,GAAiBzN,GACxB,GAAIvD,GAAO,IACX,IAAIuD,IACFvD,EAAO4P,EAAQxO,IAAImC,IACdvD,GACH,KAAM,IAAIoE,OAAM,QAAUb,EAAW,oBAGzC,IAAIiQ,GAAWjR,EAAOkR,UACtBlR,GAAOL,OAAO6B,UAAU,uBAAwB/D,EAAMwT,IACtDjR,EAAOkR,WAAazT,EACpBuC,EAAOL,OAAO6B,UAAU,wBAAyB/D,EAAMwT,IApQzD,GAAItC,GAAc5B,EAAIoE,QAAQ,oBAC1BtT,GACFuT,UAAU,EACVzD,qBAAsB,IACtBE,qBAAsB,IAEpBU,KACAlB,EAAU,GAAI3N,KACdgO,EAAyB,GAAI2D,KAC7BzD,EAAyB,GAAIyD,KAC7BtD,GACFuD,gBAAiB,KACjBC,gBAAiB,MAGfvR,GACFkR,WAAY,KACZrT,SAAUA,EACV0Q,SAAUA,EACVlB,QAASA,EACToB,iBAAkBA,EAClBzB,mBAAoBA,EACpBrN,OAAQ,GAAI0B,IAGV4G,GAA4B,EAC5BC,GAAoB,EACpBC,EAAiBC,MAErB,KACE,IAAK,GAA0DC,GAAtDC,EAAYjL,EAAWmU,WAAWjJ,OAAOC,cAAsBP,GAA6BI,EAAQC,EAAUG,QAAQC,MAAOT,GAA4B,EAAM,CACtK,GAAImG,GAAS/F,EAAMO,KAEnBuF,GAAQC,IAEV,MAAOvI,GACPqC,GAAoB,EACpBC,EAAiBtC,ECMjB,QDJA,KACOoC,GAA6BK,EAAAA,WAChCA,EAAAA,YCOF,QDJA,GAAIJ,EACF,KAAMC,IAaZ,MARA9K,GAAWsC,OAAOC,GAAG,aAAcuO,GAEnC9Q,EAAWsC,OAAOC,GAAG,aAAc6P,GACnCpS,EAAWsC,OAAOC,GAAG,aAAckQ,GAEnCxS,EAAQqC,OAAOC,GAAG,qBAAsB4Q,GACxClT,EAAQqC,OAAOC,GAAG,OAAQ6Q,GAEnBzQ,ECzDT6M,EAAchN,SAAW,WAAY,eAAgB,MAAO,aAAc,WDJ1E7C,QAAQC,OAAO,qCAAqC6C,QAAQ,SAAU+M,MA+QxE,WAGE7P,QAAQC,OAAO,yCAA0C,sCAAuC,6CAMlG,WAKE,QAASwU,GAAkBpQ,EAAcqQ,GAmBvC,QAASlR,GAAWnB,GAClB,GAAI1B,GAAUsM,UAAU7F,QAAU,GAAsBgE,SAAjB6B,UAAU,GAAmB,GAAKA,UAAU,GAC/ElL,EAAOkL,UAAU7F,QAAU,GAAsBgE,SAAjB6B,UAAU,GAAmB,KAAOA,UAAU,GAE9ExM,EAAO,GAAIiU,GAAWrS,EAAM1B,EAASoB,EAEzC,IADAM,EAAO5B,EAAK4B,KACRgO,EAAQsE,IAAItS,GACd,KAAM,IAAIwC,OAAM,wBAA0BxC,EAM5C,OAJAsN,QAAOiF,OAAOnU,GACdJ,EAAWsC,OAAO6B,UAAU,aAAc/D,IAC1C4P,EAAQlO,IAAIE,EAAM5B,GAClBJ,EAAWsC,OAAO6B,UAAU,cAAe/D,IACpCA,EAGT,QAASoU,GAASxS,GAChB,MAAO9B,GAAQ8B,GAAM1B,QAGvB,QAASJ,GAAQ8B,GACf,GAAI5B,GAAO4P,EAAQxO,IAAIQ,EACvB,KAAK5B,EACH,KAAM,IAAIoE,OAAM,yBAA2BxC,EAE7C,OAAO5B,GAGT,QAASqU,GAAYzS,GACnB,MAAO9B,GAAQ8B,GAAMN,KAGvB,QAASyS,KACP,MAAOnE,GAAQF,SAGjB,QAASlL,GAAQ5C,GACf,MAAOgO,GAAQsE,IAAItS,GAGrB,QAASiO,GAAWjO,EAAM1B,GACxB,GAAIF,GAAO4P,EAAQxO,IAAIQ,EACvB,KAAK5B,EACH,KAAM,IAAIoE,OAAM,yBAA2BxC,EAE7C,IAAuB,mBAAZ1B,GACT,KAAM,IAAIkE,OAAM,0CAA4CxC,EAE9D,IAAIG,GAAU,GAAIkS,GAAWrS,EAAM1B,EAASF,EAAKsB,KACjD4N,QAAOiF,OAAOpS,GACdnC,EAAWsC,OAAO6B,UAAU,aAAchC,EAAS/B,IACnD4P,EAAQlO,IAAIE,EAAMG,GAClBnC,EAAWsC,OAAO6B,UAAU,cAAehC,EAAS/B,IAGtD,QAASgS,GAAWpQ,EAAMqQ,GACxB,GAAIjS,GAAO4P,EAAQxO,IAAIQ,EACvB,KAAK5B,EACH,KAAM,IAAIoE,OAAM,yBAA2BxC,EAE7C,IAAIA,IAASqQ,EAAb,CAGA,GAAIrC,EAAQsE,IAAIjC,GACd,KAAM,IAAI7N,OAAM,wBAA0BxC,EAE5C,IAAIG,GAAU/B,EAAKC,MAOnB,OANA8B,GAAQuS,OAAOrC,GACf/C,OAAOiF,OAAOpS,GACdnC,EAAWsC,OAAO6B,UAAU,aAAchC,EAAS/B,IACnD4P,EAAAA,UAAehO,GACfgO,EAAQlO,IAAIuQ,EAASlQ,GACrBnC,EAAWsC,OAAO6B,UAAU,cAAehC,EAAS/B,IAC7C+B,GAGT,QAASsQ,GAAWzQ,GAClB,GAAI5B,GAAO4P,EAAQxO,IAAIQ,EACvB,KAAK5B,EACH,KAAM,IAAIoE,OAAM,yBAA2BxC,EAE7ChC,GAAWsC,OAAO6B,UAAU,aAAc/D,IAC1C4P,EAAAA,UAAehO,GACfhC,EAAWsC,OAAO6B,UAAU,cAAe/D,IAG7C,QAASqE,KACP,GAAImG,IAA4B,EAC5BC,GAAoB,EACpBC,EAAiBC,MAErB,KACE,IAAK,GAAmDC,GAA/CC,EAAY+E,EAAQ2E,OAAOzJ,OAAOC,cAAsBP,GAA6BI,EAAQC,EAAUG,QAAQC,MAAOT,GAA4B,EAAM,CAC/J,GAAIjH,GAAWqH,EAAMO,KAErBvL,GAAWyS,WAAW9O,IAExB,MAAO6E,GACPqC,GAAoB,EACpBC,EAAiBtC,ECOjB,QDLA,KACOoC,GAA6BK,EAAAA,WAChCA,EAAAA,YCQF,QDLA,GAAIJ,EACF,KAAMC,KA7Hd,GAAI9K,IACFmD,WAAYA,EACZqR,SAAUA,EACVtU,QAASA,EACTuU,YAAaA,EACbN,SAAUA,EACVvP,QAASA,EACTqL,WAAYA,EACZmC,WAAYA,EACZK,WAAYA,EACZhO,MAAOA,EACPnC,OAAQ,GAAI0B,IAGVgM,EAAU,GAAI3N,IAElB,OAAOrC,GCdToU,EAAkB5R,SAAW,eAAgB,cDL7C7C,QAAQC,OAAO,yCAAyC6C,QAAQ,aAAc2R,MA2IhF,WAGEzU,QAAQC,OAAO,yCAA0C,0CAA2C,2CAMtG,WAKE,QAASgV,GAAkBC,EAAkBC,GAM3C,QAAST,GAAWrS,GAClB,GAAI1B,GAAUsM,UAAU7F,QAAU,GAAsBgE,SAAjB6B,UAAU,GAAmB,GAAKA,UAAU,GAC/ElL,EAAOkL,UAAU7F,QAAU,GAAsBgE,SAAjB6B,UAAU,GAAmB,KAAOA,UAAU,EAElF,IAAI5K,YAAgBL,MAAM,CACxB,GAAIvB,GAAO4B,CACXyD,MAAKzD,KAAO5B,EAAK4B,KACjByD,KAAKrF,KAAOA,EACZqF,KAAK/D,KAAOtB,EAAKsB,MAAQoT,EAASC,OAAO3U,EAAK4B,UAE9CyD,MAAKzD,KAAOA,EACZyD,KAAKnF,QAAUA,EACfmF,KAAK/D,KAAOA,GAAQoT,EAASC,OAAO/S,EAEtC,KAAKyD,KAAKzD,KACR,KAAM,IAAIwC,OAAM,mBAIpB,QAASnE,KACP,MAAO,IAAIgU,GAAW5O,KAAKrF,MAAQqF,KAAKzD,KAAMyD,KAAKnF,QAASmF,KAAK/D,MAGnE,QAASgT,GAAOrC,GACd,GAAIjS,GAAOqF,KAAKrF,IAChB,IAAIA,EAAM,CACR,GAAI+B,GAAU0S,GAAkBzU,GAAOiS,GACrC3Q,KAAMtB,EAAKsB,KACXsT,aAAc5U,EAAK4U,cAErBvP,MAAKrF,KAAO+B,EAEdsD,KAAKzD,KAAOqQ,EAlCd,MAHAgC,GAAWtK,UAAU1J,KAAOA,EAC5BgU,EAAWtK,UAAU2K,OAASA,EAEvBL,ECATO,EAAkBpS,SAAW,mBAAoB,YDNjD7C,QAAQC,OAAO,yCAAyC6C,QAAQ,aAAcmS,MAgDhF,WAGEjV,QAAQC,OAAO,+CAAgD,2CAMjE,WAKE,QAASqV,GAAwBrS,GAM/B,QAASgH,GAAKsL,EAAOC,GACnBvS,EAAS0C,UAAU6P,GACnBvS,EAASkD,SAEToP,EAAME,IAAI,WAAY,WACpBxS,EAAS0C,UAAU,QAVvB,OACE+P,SAAU,IACVzL,KAAMA,GCEVqL,EAAwBzS,SAAW,YDPnC7C,QAAQC,OAAO,+CAA+C0V,UAAU,iBAAkBL,MAsB5F,WAGEtV,QAAQC,OAAO,uDAAwD,iBAMzE,WAKE,QAAS2V,KAOP,QAAS3L,GAAKsL,EAAOC,EAASK,EAAOC,GAOnC,QAASC,GAAmBC,GAK1B,MAJIF,GAAaG,iBACfJ,EAAMK,UAAU,mBAChBJ,EAAaG,eAAeT,QAAQW,SAAS,YAExCC,EAAgBJ,GAGzB,QAASK,GAAkBC,GAKzB,MAJIR,GAAaG,gBACfH,EAAaG,eAAeT,QAAQe,YAAY,WAElDV,EAAMW,aAAa,mBACZC,EAAeH,GAnBxB,GAAIF,GAAkBN,EAAaM,gBAC/BK,EAAiBX,EAAaW,cAElCX,GAAaM,gBAAkBL,EAC/BD,EAAaW,eAAiBJ,EAXhC,OACEX,SAAU,IACVvB,QAAS,WACTlK,KAAMA,GANVjK,QAAQC,OAAO,uDAAuD0V,UAAU,yBAA0BC,MAsC5G,WAGE5V,QAAQC,OAAO,gDAAiD,6BAA8B,yCAMhG,WAKE,QAASyW,GAAyB5G,EAAUC,EAAK/M,GAM/C,QAAS2T,GAASC,EAAQC,EAAUC,GAWlC,QAASC,KACP,GAAI7C,GAAalR,EAAOkR,WACpB8C,EAAa,IACb9C,KAAeA,EAAWzT,OAC5BuW,EAAa9C,GAEf+C,EAAKC,WAAWF,GAChBC,EAAKE,QAGP,QAASC,KACPpU,EAAOL,OAAO0U,IAAI,uBAAwBN,GArB5C,GAAIE,GAAOlH,EAAIuH,KAAKT,EAAS,GAC7BU,QAAON,KAAOA,EACdA,EAAKO,gBAAkBC,EAAAA,EAEvBzU,EAAOL,OAAOC,GAAG,uBAAwBmU,GAEzCH,EAAOnB,IAAI,WAAY2B,GACvBL,IACAH,EAAOc,MAAMZ,EAAOa,uBAAyBC,MAAOX,IAdtD,OACEvB,SAAU,IACVzL,KAAM0M,GCGVD,EAAyB7T,SAAW,WAAY,MAAO,UDRvD7C,QAAQC,OAAO,gDAAgD0V,UAAU,kBAAmBe,MAuC9F,WAGE1W,QAAQC,OAAO,2CAA4C,YAAa,eAAgB,aAAc,6BAA8B,oCAAqC,wCAAyC,4CAA6C,8CAA+C,sDAAuD,oDAMvW,WAUE,QAAS4X,GAAqBjB,EAAQlR,EAASoK,EAAUgI,EAAY/H,EAAK/M,EAAQ3C,GA8BhF,QAAS0X,KACHrS,EAAQsS,YAAcC,IACxBC,EAASC,YAAc,GACvBC,EAAMC,gBAAiB,GAEzBzB,EAAOnB,IAAI,mBAAoB,WAC7B3F,EAAS,WACHpK,EAAQsS,WAAaC,GACvBK,EAAU/G,UAAW,EACrB+G,EAAUtV,QAAS,EACnBsV,EAAUC,UAAW,IAErBD,EAAU/G,UAAW,EACrB+G,EAAUtV,QAAS,EACnBsV,EAAUC,UAAW,OAM7B,QAASC,GAAsBvB,GAC7BwB,EAAkBxB,GAGpB,QAASwB,GAAkBxB,GACzBA,EAAKyB,SAASC,aACZC,UACEC,SACErR,IAAK,SACLsR,IAAK,YACLC,OAAQ,cAEVC,KAAM,WACJ,GAAIvY,GAAOuC,EAAOkR,UAClB7T,GAAWiQ,WAAW7P,EAAK4B,KAAM5B,EAAKE,WAG1C6B,SACEqW,SACErR,IAAK,SACLsR,IAAK,YACLC,OAAQ,cAEVC,KAAM,WACJpC,EAAOqC,OAAO,WACZC,UAOV,QAASA,KACP,GAAIC,GAAczT,EAAQ0T,OAAO,eAC7BD,IACF9Y,EAAWmD,WAAW2V,GAI1B,QAASE,GAAqB5Y,GAC5B,GAAI0Y,GAAczT,EAAQ0T,OAAO,cAAe3Y,EAAK4B,KACjD8W,IACF9Y,EAAWoS,WAAWhS,EAAK4B,KAAM8W,GAIrC,QAAS1H,GAAiBhR,GACxB6X,EAAUtV,QAAS,EACnBA,EAAOyO,iBAAiBhR,EAAK4B,MAG/B,QAASiX,KACPhB,EAAUtV,QAAUsV,EAAUtV,OAC1BsV,EAAUtV,QACZuW,EAAkCjB,EAAU/G,SAC5C+G,EAAU/G,UAAW,GACXgI,IACVjB,EAAU/G,UAAW,GAIzB,QAASiI,GAAY1V,GACnB,GAAImH,IAA4B,EAC5BC,GAAoB,EACpBC,EAAiBC,MAErB,KA8BE,IAAK,GAA0CC,GA7B3CoO,EAAQ,WACV,GAAIhZ,GAAO4K,EAAMO,KAGjB,KAAKnL,EAAK4B,KAAM,CAMd,IAJA,GAAIqX,GAA0B,cAAdjZ,EAAKsB,KAAuB,OAAS,GACjD2Q,EAAU,eACViH,EAAU,EACVtX,EAAOqQ,EAAUgH,EACdrZ,EAAW4E,QAAQ5C,IACxBA,EAAOqQ,EAAU,OAAQiH,EAAUD,CAErCjZ,GAAK4B,KAAOA,EAGdyV,EAAW8B,WAAWnZ,EAAM2K,OAAWwL,GAAQhT,KAAK,SAAUG,GACxD8V,EAAe9V,GACjB1D,EAAWmD,WAAW/C,GAEtBJ,EAAWmD,WAAW/C,EAAK4B,KAAM0B,EAAMtD,EAAKsB,OAE7C,SAAU8G,GAEXiR,QAAQ5V,MAAM2E,MAKTyC,EAAYxH,EAAMyH,OAAOC,cAAsBP,GAA6BI,EAAQC,EAAUG,QAAQC,MAAOT,GAA4B,EAChJwO,IAEF,MAAO5Q,GACPqC,GAAoB,EACpBC,EAAiBtC,ECWjB,QDTA,KACOoC,GAA6BK,EAAAA,WAChCA,EAAAA,YCYF,QDTA,GAAIJ,EACF,KAAMC,KAMd,QAAS0O,GAAeE,GAEtB,MAAQ,uBAAuBzH,KAAKyH,GAKtC,QAASC,GAAWvZ,GAClB,GAAIwZ,GAAkBvU,EAAQwU,QAAQ,wCAA0CzZ,EAAK4B,KAAO,IACxF4X,IACF5Z,EAAWyS,WAAWrS,EAAK4B,MA9K/B,GAAI+V,GAAQtS,KAERoS,GACFiC,KAAM,SACNC,eAAe,EACfjC,YAAa,GAEXG,GACF/G,UAAU,EACVvO,QAAQ,EACRuV,UAAU,GAERgB,EAAkC,MAEtCvZ,SAAQqa,OAAOjC,GACbF,SAAUA,EACVI,UAAWA,EACXtV,OAAQA,EACRwV,sBAAuBA,EACvB/G,iBAAkBA,EAClB6H,qBAAsBA,EACtBJ,kBAAmBA,EACnBG,qBAAsBA,EACtBG,YAAaA,EACbQ,WAAYA,IAGdjC,IC1BFF,EAAqBhV,SAAW,SAAU,UAAW,WAAY,aAAc,MAAO,SAAU,aDThG,IAAIoV,GAAiB,GAErBjY,SAAQC,OAAO,2CAA2Cqa,UAAU,cAClEzT,YAAa,4CACb0T,WAAY1C,OA2LhB,WAGE7X,QAAQC,OAAO,qBAAsB,UAAW,YAAa,+CAM/D,WAKE,QAASua,GAAaC,EAAoBC,GACxCD,EAAmBE,UAAU,6CAE7BD,EAAeE,MAAM,UACnBC,YAAU,EACVjU,SAAU,gCACTgU,MAAM,gBACPpa,IAAK,SACLsa,SACEC,UAAA,OAAA,iBAAU,SAAkB3X,EAAMe,GAChC,IACEA,EAAed,QACf,MAAOwF,GACPzF,EAAKc,MAAM2E,SAIhB+R,MAAM,kBACPpa,IAAK,mBACLsa,SACEC,UAAA,OAAA,eAAA,iBAAU,SAAkB3X,EAAM4X,EAAc7W,GAC9C,IACEA,EAAeT,WAAWsX,EAAaC,QACvC,MAAOpS,GACPzF,EAAKc,MAAM2E,SChBrB2R,EAAa3X,SAAW,qBAAsB,kBDV9C7C,QAAQC,OAAO,qBAAqBmN,OAAOoN,MAqC7C,WAKE,QAASpN,GAAO8N,GACdA,EAAaC,aAAmC,cAAtB5U,SAAS6U,UCQrChO,EAAOvK,SAAW,gBDXlB7C,QAAQC,OAAO,qBAAqBmN,OAAOA,MAU7C,WA6BE,QAASgI,GAAOpR,GACd,GAAKA,EAAL,CACA,GAAIqX,GAAiBrX,EAASsX,YAAY,KAAO,EAC7C5B,EAAY1V,EAASuF,MAAM8R,EAC/B,OAAOvV,MAAKyV,MAAM7B,IA9BpB,GAAI8B,GAAY7L,OAAOrB,OAAO,KAC9BtO,SAAQqa,OAAOmB,GACbC,IAAK,YACLC,IAAK,WACLC,IAAK,YACL7T,KAAM,YACN8T,IAAK,iBACLC,IAAK,aACLC,KAAM,aACNC,IAAK,aACLC,GAAI,yBACJC,KAAM,mBACNC,IAAK,YACLC,IAAK,gBACLC,KAAM,aACNC,KAAM,aACNC,IAAK,oBAGPtc,QAAQC,OAAO,0CAEZsc,SAAS,YACVhB,MAAOC,EACPpG,OAAQA,OAeZ,WAOE,QAASjV,GAAMkC,EAAMma,GACnB,MAAKA,GACEC,UAAUpa,EAAMma,IADF,EALvBxc,QAAQC,OAAO,uCAEZsc,SAAS,YAAaE,WAAWF,SAAS,QAASpc,MAYxD,WAGEH,QAAQC,OAAO,qCAEZsc,SAAS,UAAWzb,YAOzB,WAGEd,QAAQC,OAAO,yCAEZsc,SAAS,cAAenc,gBAM7B,WAOE,QAAS8U,GAAiBwH,EAAOC,GAC/B,GAAIC,GAAa3P,UAAU7F,QAAU,GAAsBgE,SAAjB6B,UAAU,MAAwBA,UAAU,GAElFxM,EAAO,MACX,KACEA,EAAO,GAAIoc,MAAKH,EAAOC,EAAUC,GACjC,MAAO/T,GAEP,GAAIiU,GAAO,MAETA,GADE,gBAAkBF,GACb,GAAIG,MAAKH,EAAWvH,cAEpB,GAAI0H,MAEbtc,EAAO,GAAIuB,MAAK0a,EAAOE,GACvBnc,EAAK4B,KAAOsa,EACZlc,EAAK4U,cAAgByH,EACrBrc,EAAKuc,iBAAmBF,EAE1B,MAAOrc,GAvBTT,QAAQC,OAAO,8CAEZsc,SAAS,mBAAoBrH,MA6BlC,WAGElV,QAAQC,OAAO,iCAEZsc,SAAS,MAAOxM,QAOrB,WAGE/P,QAAQC,OAAO,0CAEZsc,SAAS,eAAgBlY,iBAI9BrE,QAAQC,OAAO,qBAAqB8C,KAAK,iBAAkB,SAASka,GAAiBA,EAAepK,IAAI,4CAA4C","file":"scripts/app-f88bc13e40.js","sourcesContent":["'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.serverRouter', ['bsInjularLiveDemo.deps.minimatch', 'bsInjularLiveDemo.deps.fileChanger', 'bsInjularLiveDemo.services.fileSystem', 'bsInjularLiveDemo.services.project']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.serverRouter').factory('serverRouter', serverRouterFactory);\n\n  function serverRouterFactory(match, fileChanger, fileSystem, project) {\n    var _blobUrlCache = new Map();\n\n    var serverRouter = {\n      _blobUrlCache: _blobUrlCache,\n      getBlobUrl: getBlobUrl,\n      getFile: getFile,\n      getFileContent: getFileContent\n    };\n\n    fileSystem.events.on('postModify', removeFileCache);\n    fileSystem.events.on('postRename', renameFileCache);\n    fileSystem.events.on('postDelete', removeFileCache);\n\n    return serverRouter;\n\n    function getFile(url) {\n      var file = fileSystem.getFile(url).copy();\n      if (file.file) return file;\n      var content = file.content;\n      var injSettings = project.settings.injular;\n      if (match(url, injSettings.templates)) {\n        content = fileChanger.wrapTemplate(content, url);\n      } else if (match(url, injSettings.directives)) {\n        content = fileChanger.wrapDirectiveFile(content, url);\n      } else if (match(url, injSettings.moduleFile)) {\n        content = fileChanger.appendProvideGetter(content, injSettings.ngApp);\n      } else if (match(url, injSettings.angularFile)) {\n        content = fileChanger.appendAngularModulePatch(content);\n      }\n      file.content = content;\n      return file;\n    }\n\n    function getFileContent(url) {\n      return serverRouter.getFile(url).content;\n    }\n\n    function getBlobUrl(url) {\n      var blobUrl = _blobUrlCache.get(url);\n      if (!blobUrl) {\n        var file = serverRouter.getFile(url);\n        var blob = void 0;\n        if (file.file) {\n          blob = file.file;\n        } else {\n          var content = file.content;\n          var type = file.type;\n          blob = new Blob([content], { type: type });\n        }\n        blobUrl = URL.createObjectURL(blob);\n        _blobUrlCache.set(url, blobUrl);\n      }\n      return blobUrl;\n    }\n\n    function removeFileCache(file) {\n      var blobUrl = _blobUrlCache.get(file.name);\n      if (blobUrl) {\n        URL.revokeObjectURL(blobUrl);\n        _blobUrlCache.delete(file.name);\n      }\n    }\n\n    function renameFileCache(newFile, oldFile) {\n      removeFileCache(oldFile);\n      serverRouter.getBlobUrl(newFile.name);\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.projectCreator', ['bsInjularLiveDemo.services.project', 'bsInjularLiveDemo.services.fileSystem',\n\n  // listen to fileSystem events:\n  'bsInjularLiveDemo.services.editor', 'bsInjularLiveDemo.services.serverRouter', 'bsInjularLiveDemo.services.liveDemo'])\n  /* eslint-disable no-unused-vars */\n  .run(function (editor, serverRouter, liveDemo) {});\n  /* eslint-enable no-unused-vars */\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.projectCreator').factory('projectCreator', projectCreatorFactory);\n\n  function projectCreatorFactory($http, $log, project, fileSystem) {\n    var projectCreator = {\n      blank: blank,\n      githubGist: githubGist\n    };\n\n    return projectCreator;\n\n    function blank() {\n      var origin = 'blank';\n      if (project.origin === origin) return;\n      project.origin = origin;\n      project.startLoading();\n      fileSystem.createFile('index.html', '<!doctype html>\\n<html>\\n  <head>\\n    <meta charset=\"utf-8\">\\n    <style>[ng-cloak] { display: none; }</style>\\n  </head>\\n  <body ng-app=\"app\">\\n    <!--\\n    <script src=\"//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.js\"></script>\\n    -->\\n  </body>\\n</html>\\n');\n      project.doneLoading();\n    }\n\n    function githubGist(id) {\n      var origin = 'gh-gist_' + id;\n      if (project.origin === origin) return;\n      project.origin = origin;\n      project.startLoading();\n      return $http.get('https://api.github.com/gists/' + id).then(function (response) {\n        var files = response.data.files;\n        for (var fileName in files) {\n          var file = files[fileName];\n          fileSystem.createFile(fileName, file.content, file.type);\n        }\n        project.doneLoading();\n      }, function (errResponse) {\n        $log.error(errResponse);\n      });\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.project', ['bsInjularLiveDemo.deps.EventEmitter', 'bsInjularLiveDemo.services.fileSystem']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  var PROJECT_SETTINGS_FILENAME = '.injular.json';\n\n  angular.module('bsInjularLiveDemo.services.project').factory('project', projectFactory);\n\n  function projectFactory(EventEmitter, fileSystem) {\n    var project = {\n      get SETTINGS_FILENAME() {\n        return PROJECT_SETTINGS_FILENAME;\n      },\n      origin: null,\n      loading: false,\n      startLoading: startLoading,\n      doneLoading: doneLoading,\n      events: new EventEmitter()\n    };\n    resetSettings();\n\n    fileSystem.events.on('postCreate', fileChangeListener);\n    fileSystem.events.on('postModify', fileChangeListener);\n    fileSystem.events.on('preRename', filePredeleteListener);\n    fileSystem.events.on('preDelete', filePredeleteListener);\n\n    return project;\n\n    function fileChangeListener(file) {\n      if (file.name === PROJECT_SETTINGS_FILENAME) {\n        project.events.emitEvent('preModifySettings');\n        project.settings = JSON.parse(file.content);\n        if (!project.settings.injular) {\n          project.settings.injular = {};\n        }\n        project.events.emitEvent('postModifySettings');\n      }\n    }\n\n    function filePredeleteListener(newFile, oldFile) {\n      var file = oldFile || newFile;\n      if (file.name === PROJECT_SETTINGS_FILENAME && !project.loading) {\n        throw new Error(PROJECT_SETTINGS_FILENAME + ' file cannot be deleted');\n      }\n    }\n\n    function startLoading() {\n      project.loading = true;\n      fileSystem.clear();\n      resetSettings();\n    }\n\n    function doneLoading() {\n      autoAddSettingsFile();\n      project.loading = false;\n      project.events.emitEvent('init');\n    }\n\n    function resetSettings() {\n      project.settings = { injular: {} };\n    }\n\n    function autoAddSettingsFile() {\n      if (!fileSystem.hasFile(project.SETTINGS_FILENAME)) {\n        var settings = {\n          entryFile: 'index.html',\n          injular: {\n            templates: '**/!(index).html',\n            controllers: '**/*.controller?(s).js',\n            directives: '**/*.+(directive?(s)|component?(s)).js',\n            filters: '**/*.filter?(s).js',\n            angularFile: '**/angular?(.min).js',\n            moduleFile: '**/+(app|index)?(.module).js'\n          },\n          fileOrder: ['.injular.json']\n        };\n        var content = JSON.stringify(settings, null, 2);\n        fileSystem.createFile(project.SETTINGS_FILENAME, content);\n      }\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.liveDemo', ['bsInjularLiveDemo.deps.EventEmitter', 'bsInjularLiveDemo.deps.minimatch', 'bsInjularLiveDemo.deps.injular', 'bsInjularLiveDemo.deps.fileChanger', 'bsInjularLiveDemo.services.fileSystem', 'bsInjularLiveDemo.services.serverRouter', 'bsInjularLiveDemo.services.project']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.liveDemo').factory('liveDemo', liveDemoFactory);\n\n  function liveDemoFactory($log, $window, EventEmitter, match, injular, fileChanger, fileSystem, serverRouter, project) {\n    var domain = $window.location.protocol + '//' + $window.location.host;\n\n    var liveDemo = {\n      events: new EventEmitter(),\n      setIframe: setIframe,\n      reload: reload,\n      _replaceDocument: _replaceDocument\n    };\n\n    fileSystem.events.on('postCreate', fileModifiedListener);\n    fileSystem.events.on('postRename', fileModifiedListener);\n    fileSystem.events.on('postModify', fileModifiedListener);\n    fileSystem.events.on('postDelete', _reloadFn);\n\n    project.events.on('init', _reloadFn);\n    project.events.on('postModifySettings', _reloadFn);\n\n    return liveDemo;\n\n    function setIframe($iframe) {\n      var _this = this;\n\n      if (this.$iframe === $iframe) return;\n      this.$iframe = $iframe;\n      this._injular = null;\n      this._window = null;\n      if (!$iframe) return;\n      this._window = $iframe[0].contentWindow;\n      if (!this._window) {\n        throw new Error('Iframe does not have a window');\n      }\n      this.$iframe.on('load', function () {\n        if ($iframe === _this.$iframe) {\n          _this._window = _this.$iframe[0].contentWindow;\n          _this._replaceDocument();\n        }\n      });\n    }\n\n    function reload() {\n      if (!this._window) return;\n      if (project.loading) {\n        this._window.document.body.textContent = 'Loading...';\n      } else {\n        this._window.location.replace('about:blank');\n        this._injular = null;\n      }\n    }\n\n    function _reloadFn() {\n      liveDemo.reload();\n    }\n\n    function fileModifiedListener(file) {\n      var settings = project.settings;\n      if (!liveDemo._injular) {\n        liveDemo.reload();\n      } else if (match(file.name, settings.injular.templates)) {\n        var content = serverRouter.getFileContent(file.name);\n        liveDemo._injular.injectTemplate({\n          template: content,\n          templateUrl: file.name,\n          reloadRoute: settings.injular.reloadRouteOnTemplateInjection,\n          avoidCleanScope: settings.injular.avoidCleanScope,\n          logLevel: settings.logLevel\n        });\n      } else {\n        var recipes = getNgRecipes(file.name);\n        if (recipes.length) {\n          liveDemo._injular.injectScript({\n            script: file.content,\n            scriptUrl: file.name,\n            recipes: recipes,\n            logLevel: settings.logLevel\n          });\n        } else {\n          liveDemo.reload();\n        }\n      }\n    }\n\n    function _replaceDocument() {\n      if (project.settings.entryFile) {\n        var win = this._window;\n        var doc = win.document.open();\n        this.events.emitEvent('preReplaceDocument');\n        injular.newInstance(win, doc);\n        this._injular = win.injular;\n        delete win.injular;\n        win.___setUpSinonFakeRequest = getSetUpSinonFakeRequestFn(win);\n        var html = getDocumentHtmlString();\n        doc.write(html);\n        doc.close();\n        observerDomMutation(doc);\n        this.events.emitEvent('postReplaceDocument');\n      }\n    }\n\n    function getNgRecipes(name) {\n      var injSettings = project.settings.injular;\n      var recipes = [];\n      if (match(name, injSettings.controllers)) {\n        recipes.push('controller');\n      } else if (match(name, injSettings.directives)) {\n        recipes.push('directive');\n      } else if (match(name, injSettings.filters)) {\n        recipes.push('filter');\n      }\n      return recipes;\n    }\n\n    function getDocumentHtmlString() {\n      var entryFile = project.settings.entryFile;\n      try {\n        var initialHtml = serverRouter.getFileContent(entryFile);\n        var doc = htmlToDom(initialHtml);\n        modifyDocumentScriptsSrc(doc);\n        modifyDocumentLinksHref(doc);\n        modifyDocumentImgsSrc(doc);\n        prependSinonFakeRequest(doc);\n        return getDoctypeHtml(doc) + doc.documentElement.outerHTML;\n      } catch (err) {\n        $log.error(err);\n        return '<p style=\"color:red\">' + err + '</p>';\n      }\n    }\n\n    function htmlToDom(content) {\n      var doc = document.implementation.createHTMLDocument();\n      doc.open();\n      doc.write('<base href=\"/\">\\n' + content);\n      doc.close();\n      return doc;\n    }\n\n    function modifyDocumentScriptsSrc(doc) {\n      var scripts = doc.scripts;\n      for (var i = 0; i < scripts.length; i++) {\n        var script = scripts[i];\n        var src = script.src;\n        if (src.startsWith(domain) && script.getAttribute('src')) {\n          var srcPath = src.slice(domain.length + 1);\n          var blobUrl = serverRouter.getBlobUrl(srcPath);\n          script.setAttribute('injular-src', src);\n          script.setAttribute('src', blobUrl);\n        } else if (match(src, project.settings.injular.angularFile)) {\n          var newScript = doc.createElement('script');\n          newScript.text = fileChanger.appendAngularModulePatch('');\n          script.parentNode.insertBefore(newScript, script.nextSibling);\n        }\n      }\n    }\n\n    function modifyDocumentLinksHref(doc) {\n      var links = doc.getElementsByTagName('link');\n      for (var i = 0; i < links.length; i++) {\n        var link = links[i];\n        var href = link.href;\n        if (String.prototype.startsWith.call(href, domain)) {\n          var path = href.slice(domain.length);\n          if (path.startsWith('/')) {\n            path = path.slice(1);\n          }\n          var blobUrl = serverRouter.getBlobUrl(path);\n          link.setAttribute('href', blobUrl);\n        }\n      }\n    }\n\n    function modifyDocumentImgsSrc(doc) {\n      var imgs = doc.getElementsByTagName('img');\n      for (var i = 0; i < imgs.length; i++) {\n        var img = imgs[i];\n        blobifyImgSrc(img);\n      }\n    }\n\n    function prependSinonFakeRequest(doc) {\n      if (liveDemo._noRequests) return;\n      var sinonFilterScriptElement = doc.createElement('script');\n      sinonFilterScriptElement.text = 'window.___setUpSinonFakeRequest();delete window.___setUpSinonFakeRequest;delete window.sinon;';\n      doc.head.insertBefore(sinonFilterScriptElement, doc.head.firstChild);\n\n      var sinonScriptElement = doc.createElement('script');\n      sinonScriptElement.setAttribute('src', 'assets/sinon-server-1.17.3.js');\n      doc.head.insertBefore(sinonScriptElement, doc.head.firstChild);\n    }\n\n    function observerDomMutation(doc) {\n      if (typeof MutationObserver === 'undefined') return;\n      var observer = new MutationObserver(callback);\n      var config = { attributes: true, childList: true, subtree: true };\n      observer.observe(doc, config);\n\n      var createElement = doc.createElement;\n      doc.createElement = observeCreateElement;\n\n      function callback(mutations) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = mutations[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var mutation = _step.value;\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n              for (var _iterator2 = mutation.addedNodes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                var node = _step2.value;\n\n                blobifyImgSrc(node);\n                var tw = document.createTreeWalker(node, NodeFilter.SHOW_ELEMENT, function (node) {\n                  if (node.tagName === 'IMG') {\n                    return NodeFilter.FILTER_ACCEPT;\n                  }\n                  return NodeFilter.FILTER_SKIP;\n                });\n                while (node = tw.nextNode()) {\n                  blobifyImgSrc(node);\n                }\n              }\n            } catch (err) {\n              _didIteratorError2 = true;\n              _iteratorError2 = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                  _iterator2.return();\n                }\n              } finally {\n                if (_didIteratorError2) {\n                  throw _iteratorError2;\n                }\n              }\n            }\n\n            if (mutation.attributeName === 'src') {\n              blobifyImgSrc(mutation.target);\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      }\n\n      function observeCreateElement() {\n        var el = createElement.apply(this, arguments);\n        observer.observe(el, config);\n        return el;\n      }\n    }\n\n    function blobifyImgSrc(node) {\n      var src = node.src || '';\n      if (String.prototype.startsWith.call(src, domain)) {\n        var path = src.slice(domain.length);\n        if (path.startsWith('/')) {\n          path = path.slice(1);\n        }\n        var blobUrl = serverRouter.getBlobUrl(path);\n        node.setAttribute('src', blobUrl);\n        node.setAttribute('injular-src', src);\n      }\n    }\n\n    function getSetUpSinonFakeRequestFn(win) {\n      return setUpSinonFakeRequest;\n\n      function setUpSinonFakeRequest() {\n        var anchor = win.document.createElement('a');\n        var server = win.sinon.fakeServer.create();\n        server.xhr.useFilters = true;\n        server.xhr.addFilter(filter);\n        server.respondWith(respondWith);\n        server.autoRespond = true;\n        var scripts = win.document.scripts;\n        win.document.head.removeChild(scripts[1]);\n        win.document.head.removeChild(scripts[0]);\n\n        function filter(method, url) {\n          try {\n            getLocalFileFromUrl(url);\n            return false;\n          } catch (err) {\n            return true;\n          }\n        }\n\n        function respondWith(xhr) {\n          var headers = {};\n          var localFile = getLocalFileFromUrl(xhr.url);\n          if (localFile.type) {\n            headers['Content-Type'] = localFile.type;\n          }\n          xhr.respond(200, headers, localFile.content);\n        }\n\n        function getLocalFileFromUrl(url) {\n          anchor.href = url;\n          var href = anchor.href;\n          if (href.startsWith(domain)) {\n            var fileName = href.slice(domain.length + 1);\n            return serverRouter.getFile(fileName);\n          }\n        }\n      }\n    }\n\n    function getDoctypeHtml(doc) {\n      var node = doc.doctype;\n      if (!node) return '';\n      return \"<!DOCTYPE \" + node.name + (node.publicId ? ' PUBLIC \"' + node.publicId + '\"' : '') + (!node.publicId && node.systemId ? ' SYSTEM' : '') + (node.systemId ? ' \"' + node.systemId + '\"' : '') + '>\\n';\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.editor', ['bsInjularLiveDemo.deps.EventEmitter', 'bsInjularLiveDemo.deps.ace', 'bsInjularLiveDemo.services.fileSystem', 'bsInjularLiveDemo.services.project']);\n})();\n\n\n'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.editor').factory('editor', editorFactory);\n\n  function editorFactory($timeout, EventEmitter, ace, fileSystem, project) {\n    var aceModelist = ace.require('ace/ext/modelist');\n    var settings = {\n      autoSave: true,\n      delayedAutoSaveDelay: 1000,\n      instantAutoSaveDelay: 80\n    };\n    var fileList = [];\n    var fileMap = new Map();\n    var delayedAutoSaveFileSet = new Set();\n    var instantAutoSaveFileSet = new Set();\n    var timeouts = {\n      delayedAutoSave: null,\n      instantAutoSave: null\n    };\n\n    var editor = {\n      activeFile: null,\n      settings: settings,\n      fileList: fileList,\n      fileMap: fileMap,\n      changeActiveFile: changeActiveFile,\n      fileContentChanged: fileContentChanged,\n      events: new EventEmitter()\n    };\n\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = fileSystem.getFiles()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var fsFile = _step.value;\n\n        addFile(fsFile);\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    fileSystem.events.on('postCreate', addFile);\n    // fileSystem.events.on('postModify', fileModifiedListener);\n    fileSystem.events.on('postRename', renameFile);\n    fileSystem.events.on('postDelete', deleteFile);\n\n    project.events.on('postModifySettings', projectSettingsModifiedListener);\n    project.events.on('init', projectInitListener);\n\n    return editor;\n\n    function fileContentChanged(file) {\n      var fileSet = void 0,\n          timeoutName = void 0,\n          delay = void 0;\n      var name = file.name;\n      if (name.endsWith('.js') || name === project.SETTINGS_FILENAME || name === project.settings.entryFile) {\n        fileSet = delayedAutoSaveFileSet;\n        timeoutName = 'delayedAutoSave';\n        delay = settings.delayedAutoSaveDelay;\n      } else {\n        fileSet = instantAutoSaveFileSet;\n        timeoutName = 'instantAutoSave';\n        delay = settings.instantAutoSaveDelay;\n      }\n      $timeout.cancel(timeouts[timeoutName]);\n      fileSet.add(name);\n      timeouts[timeoutName] = $timeout(saveFileChanges, delay);\n\n      function saveFileChanges() {\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = fileSet.values()[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var fileName = _step2.value;\n\n            var setFile = fileMap.get(fileName);\n            fileSystem.modifyFile(setFile.name, setFile.content);\n          }\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n\n        fileSet.clear();\n      }\n    }\n\n    function aceChangeListener(change, file) {\n      fileContentChanged(file);\n    }\n\n    function addFile(fsFile) {\n      var file = void 0;\n      if (fsFile.file) {\n        file = createRawFile(fsFile);\n      } else {\n        file = createAceFile(fsFile);\n      }\n      fileMap.set(file.name, file);\n      fileList.push(file);\n      reorderFileList();\n      editor.changeActiveFile(file.name);\n    }\n\n    function createAceFile(fsFile) {\n      var mode = aceModelist.getModeForPath(fsFile.name).mode;\n      var file = ace.createEditSession(fsFile.content, mode);\n      file.name = fsFile.name;\n      Object.defineProperty(file, 'content', {\n        get: function get() {\n          return file.doc.getValue();\n        },\n        set: function set(val) {\n          return file.doc.setValue(val);\n        }\n      });\n      disableEditorWarnings(file);\n      file.on('change', aceChangeListener);\n      return file;\n    }\n\n    function createRawFile(fsFile) {\n      return fsFile.copy();\n    }\n\n    function disableEditorWarnings(file) {\n      file.on('changeAnnotation', function () {\n        if (file.name.endsWith('.html') && file.name !== project.settings.entryFile) {\n          var annotations = file.getAnnotations();\n          var len = annotations.length;\n          var i = len;\n          while (i--) {\n            if (/doctype first\\. Expected/.test(annotations[i].text)) {\n              annotations.splice(i, 1);\n            }\n          }\n          if (annotations.length < len) {\n            file.setAnnotations(annotations);\n          }\n        }\n      });\n    }\n\n    // function fileModifiedListener(file) {\n    // }\n\n    function renameFile(newFile, oldFile) {\n      var newName = newFile.name;\n      var oldName = oldFile.name;\n      var file = fileMap.get(oldName);\n      fileMap.delete(oldName);\n      file.name = newName;\n      var mode = aceModelist.getModeForPath(newName).mode;\n      file.setMode(mode);\n      fileMap.set(file.name, file);\n      reorderFileList();\n\n      if (delayedAutoSaveFileSet.delete(oldName)) {\n        delayedAutoSaveFileSet.put(newName);\n      }\n      if (instantAutoSaveFileSet.delete(oldName)) {\n        instantAutoSaveFileSet.put(newName);\n      }\n    }\n\n    function deleteFile(fsFile) {\n      fileMap.delete(fsFile.name);\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = fileList.entries()[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var _step3$value = _slicedToArray(_step3.value, 2);\n\n          var index = _step3$value[0];\n          var file = _step3$value[1];\n\n          if (file.name === fsFile.name) {\n            fileList.splice(index, 1);\n            delayedAutoSaveFileSet.delete(file.name);\n            instantAutoSaveFileSet.delete(file.name);\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      var firstFile = editor.fileList[0];\n      editor.changeActiveFile(firstFile ? firstFile.name : null);\n    }\n\n    function projectSettingsModifiedListener() {\n      reorderFileList();\n    }\n\n    function projectInitListener() {\n      var firstFile = editor.fileList[0];\n      editor.changeActiveFile(firstFile ? firstFile.name : null);\n    }\n\n    function reorderFileList() {\n      var fileOrder = project.settings.fileOrder || [];\n      fileList.sort(function (left, right) {\n        var leftIndex = fileOrder.indexOf(left.name);\n        var rightIndex = fileOrder.indexOf(right.name);\n        if (leftIndex < 0) leftIndex = fileOrder.length;\n        if (rightIndex < 0) rightIndex = fileOrder.length;\n        var order = leftIndex - rightIndex;\n        if (order === 0) {\n          order = left.name <= right.name ? -1 : 1;\n        }\n        return order;\n      });\n    }\n\n    function changeActiveFile(fileName) {\n      var file = null;\n      if (fileName) {\n        file = fileMap.get(fileName);\n        if (!file) {\n          throw new Error('File ' + fileName + ' is not in editor');\n        }\n      }\n      var prevFile = editor.activeFile;\n      editor.events.emitEvent('preActiveFileChange', [file, prevFile]);\n      editor.activeFile = file;\n      editor.events.emitEvent('postActiveFileChange', [file, prevFile]);\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.fileSystem', ['bsInjularLiveDemo.deps.EventEmitter', 'bsInjularLiveDemo.services.MemoryFile']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.fileSystem').factory('fileSystem', fileSystemFactory);\n\n  function fileSystemFactory(EventEmitter, MemoryFile) {\n    var fileSystem = {\n      createFile: createFile,\n      readFile: readFile,\n      getFile: getFile,\n      getFileType: getFileType,\n      getFiles: getFiles,\n      hasFile: hasFile,\n      modifyFile: modifyFile,\n      renameFile: renameFile,\n      deleteFile: deleteFile,\n      clear: clear,\n      events: new EventEmitter()\n    };\n\n    var fileMap = new Map();\n\n    return fileSystem;\n\n    function createFile(name) {\n      var content = arguments.length <= 1 || arguments[1] === undefined ? '' : arguments[1];\n      var type = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\n      var file = new MemoryFile(name, content, type);\n      name = file.name;\n      if (fileMap.has(name)) {\n        throw new Error('File already exists: ' + name);\n      }\n      Object.freeze(file);\n      fileSystem.events.emitEvent('preCreate', [file]);\n      fileMap.set(name, file);\n      fileSystem.events.emitEvent('postCreate', [file]);\n      return file;\n    }\n\n    function readFile(name) {\n      return getFile(name).content;\n    }\n\n    function getFile(name) {\n      var file = fileMap.get(name);\n      if (!file) {\n        throw new Error('File does not exists: ' + name);\n      }\n      return file;\n    }\n\n    function getFileType(name) {\n      return getFile(name).type;\n    }\n\n    function getFiles() {\n      return fileMap.values();\n    }\n\n    function hasFile(name) {\n      return fileMap.has(name);\n    }\n\n    function modifyFile(name, content) {\n      var file = fileMap.get(name);\n      if (!file) {\n        throw new Error('File does not exists: ' + name);\n      }\n      if (typeof content === 'undefined') {\n        throw new Error('Content is needed when modifying file: ' + name);\n      }\n      var newFile = new MemoryFile(name, content, file.type);\n      Object.freeze(newFile);\n      fileSystem.events.emitEvent('preModify', [newFile, file]);\n      fileMap.set(name, newFile);\n      fileSystem.events.emitEvent('postModify', [newFile, file]);\n    }\n\n    function renameFile(name, newName) {\n      var file = fileMap.get(name);\n      if (!file) {\n        throw new Error('File does not exists: ' + name);\n      }\n      if (name === newName) {\n        return;\n      }\n      if (fileMap.has(newName)) {\n        throw new Error('File already exists: ' + name);\n      }\n      var newFile = file.copy();\n      newFile.rename(newName);\n      Object.freeze(newFile);\n      fileSystem.events.emitEvent('preRename', [newFile, file]);\n      fileMap.delete(name);\n      fileMap.set(newName, newFile);\n      fileSystem.events.emitEvent('postRename', [newFile, file]);\n      return newFile;\n    }\n\n    function deleteFile(name) {\n      var file = fileMap.get(name);\n      if (!file) {\n        throw new Error('File does not exists: ' + name);\n      }\n      fileSystem.events.emitEvent('preDelete', [file]);\n      fileMap.delete(name);\n      fileSystem.events.emitEvent('postDelete', [file]);\n    }\n\n    function clear() {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = fileMap.keys()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var fileName = _step.value;\n\n          fileSystem.deleteFile(fileName);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.MemoryFile', ['bsInjularLiveDemo.deps.createNativeFile', 'bsInjularLiveDemo.services.mimeType']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.services.MemoryFile').factory('MemoryFile', MemoryFileFactory);\n\n  function MemoryFileFactory(createNativeFile, mimeType) {\n    MemoryFile.prototype.copy = copy;\n    MemoryFile.prototype.rename = rename;\n\n    return MemoryFile;\n\n    function MemoryFile(name) {\n      var content = arguments.length <= 1 || arguments[1] === undefined ? '' : arguments[1];\n      var type = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\n      if (name instanceof Blob) {\n        var file = name;\n        this.name = file.name;\n        this.file = file;\n        this.type = file.type || mimeType.lookup(file.name);\n      } else {\n        this.name = name;\n        this.content = content;\n        this.type = type || mimeType.lookup(name);\n      }\n      if (!this.name) {\n        throw new Error('Name is missing');\n      }\n    }\n\n    function copy() {\n      return new MemoryFile(this.file || this.name, this.content, this.type);\n    }\n\n    function rename(newName) {\n      var file = this.file;\n      if (file) {\n        var newFile = createNativeFile([file], newName, {\n          type: file.type,\n          lastModified: file.lastModified\n        });\n        this.file = newFile;\n      }\n      this.name = newName;\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.directives.liveDemoIframe', ['bsInjularLiveDemo.services.liveDemo']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.directives.liveDemoIframe').directive('liveDemoIframe', liveDemoIframeDirective);\n\n  function liveDemoIframeDirective(liveDemo) {\n    return {\n      restrict: 'A',\n      link: link\n    };\n\n    function link(scope, element) {\n      liveDemo.setIframe(element);\n      liveDemo.reload();\n\n      scope.$on('$destroy', function () {\n        liveDemo.setIframe(null);\n      });\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.directives.addMovingSplitbarClass', ['ui.layout']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.directives.addMovingSplitbarClass').directive('addMovingSplitbarClass', addMovingSplitbarClassDirective);\n\n  function addMovingSplitbarClassDirective() {\n    return {\n      restrict: 'A',\n      require: 'uiLayout',\n      link: link\n    };\n\n    function link(scope, element, attrs, uiLayoutCtrl) {\n      var processSplitbar = uiLayoutCtrl.processSplitbar;\n      var mouseUpHandler = uiLayoutCtrl.mouseUpHandler;\n\n      uiLayoutCtrl.processSplitbar = processSplitbarAlt;\n      uiLayoutCtrl.mouseUpHandler = mouseUpHandlerAlt;\n\n      function processSplitbarAlt(container) {\n        if (uiLayoutCtrl.movingSplitbar) {\n          attrs.$addClass('moving-splitbar');\n          uiLayoutCtrl.movingSplitbar.element.addClass('-moving');\n        }\n        return processSplitbar(container);\n      }\n\n      function mouseUpHandlerAlt(event) {\n        if (uiLayoutCtrl.movingSplitbar) {\n          uiLayoutCtrl.movingSplitbar.element.removeClass('-moving');\n        }\n        attrs.$removeClass('moving-splitbar');\n        return mouseUpHandler(event);\n      }\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.directives.aceModelManager', ['bsInjularLiveDemo.deps.ace', 'bsInjularLiveDemo.services.editor']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.directives.aceModelManager').directive('aceModelManager', aceModelManagerDirective);\n\n  function aceModelManagerDirective($timeout, ace, editor) {\n    return {\n      restrict: 'A',\n      link: postLink\n    };\n\n    function postLink($scope, $element, $attrs) {\n      var acee = ace.edit($element[0]);\n      window.acee = acee;\n      acee.$blockScrolling = Infinity;\n\n      editor.events.on('postActiveFileChange', postEditorActiveFileChangeListener);\n\n      $scope.$on('$destroy', destroyListener);\n      postEditorActiveFileChangeListener();\n      $scope.$eval($attrs.aceModelManagerOnLoad, { $acee: acee });\n\n      function postEditorActiveFileChangeListener() {\n        var activeFile = editor.activeFile;\n        var newSession = null;\n        if (activeFile && !activeFile.file) {\n          newSession = activeFile;\n        }\n        acee.setSession(newSession);\n        acee.focus();\n      }\n\n      function destroyListener() {\n        editor.events.off('postActiveFileChange', postEditorActiveFileChangeListener);\n      }\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.components.editorView', ['ui.layout', 'ngFileUpload', 'filereader', 'bsInjularLiveDemo.deps.ace', 'bsInjularLiveDemo.services.editor', 'bsInjularLiveDemo.services.fileSystem', 'bsInjularLiveDemo.services.projectCreator', 'bsInjularLiveDemo.directives.liveDemoIframe', 'bsInjularLiveDemo.directives.addMovingSplitbarClass', 'bsInjularLiveDemo.directives.aceModelManager']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  var mobileMaxWidth = 480;\n\n  angular.module('bsInjularLiveDemo.components.editorView').component('editorView', {\n    templateUrl: 'app/components/editorView/editorView.html',\n    controller: EditorViewController\n  });\n\n  function EditorViewController($scope, $window, $timeout, FileReader, ace, editor, fileSystem) {\n    var $ctrl = this;\n\n    var uiLayout = {\n      flow: 'column',\n      disableToggle: true,\n      dividerSize: 5\n    };\n    var collapsed = {\n      fileList: false,\n      editor: false,\n      liveView: false\n    };\n    var previousCollapsedFileListStatus = void 0;\n\n    angular.extend($ctrl, {\n      uiLayout: uiLayout,\n      collapsed: collapsed,\n      editor: editor,\n      aceEditorLoadListener: aceEditorLoadListener,\n      changeActiveFile: changeActiveFile,\n      toggleEditorCollapse: toggleEditorCollapse,\n      showNewFilePrompt: showNewFilePrompt,\n      showRenameFilePrompt: showRenameFilePrompt,\n      importFiles: importFiles,\n      removeFile: removeFile\n    });\n\n    activate();\n\n    function activate() {\n      if ($window.outerWidth <= mobileMaxWidth) {\n        uiLayout.dividerSize = 10;\n        $ctrl.hideOutputMode = true;\n      }\n      $scope.$on('ui.layout.loaded', function () {\n        $timeout(function () {\n          if ($window.outerWidth > mobileMaxWidth) {\n            collapsed.fileList = false;\n            collapsed.editor = false;\n            collapsed.liveView = false;\n          } else {\n            collapsed.fileList = true;\n            collapsed.editor = true;\n            collapsed.liveView = false;\n          }\n        });\n      });\n    }\n\n    function aceEditorLoadListener(acee) {\n      setEditorCommands(acee);\n    }\n\n    function setEditorCommands(acee) {\n      acee.commands.addCommands({\n        saveFile: {\n          bindKey: {\n            win: 'Ctrl-S',\n            mac: 'Command-S',\n            sender: 'editor|cli'\n          },\n          exec: function exec() {\n            var file = editor.activeFile;\n            fileSystem.modifyFile(file.name, file.content);\n          }\n        },\n        newFile: {\n          bindKey: {\n            win: 'Ctrl-B',\n            mac: 'Command-B',\n            sender: 'editor|cli'\n          },\n          exec: function exec() {\n            $scope.$apply(function () {\n              showNewFilePrompt();\n            });\n          }\n        }\n      });\n    }\n\n    function showNewFilePrompt() {\n      var newFileName = $window.prompt('New filename');\n      if (newFileName) {\n        fileSystem.createFile(newFileName);\n      }\n    }\n\n    function showRenameFilePrompt(file) {\n      var newFileName = $window.prompt('Rename file', file.name);\n      if (newFileName) {\n        fileSystem.renameFile(file.name, newFileName);\n      }\n    }\n\n    function changeActiveFile(file) {\n      collapsed.editor = false;\n      editor.changeActiveFile(file.name);\n    }\n\n    function toggleEditorCollapse() {\n      collapsed.editor = !collapsed.editor;\n      if (collapsed.editor) {\n        previousCollapsedFileListStatus = collapsed.fileList;\n        collapsed.fileList = true;\n      } else if (!previousCollapsedFileListStatus) {\n        collapsed.fileList = false;\n      }\n    }\n\n    function importFiles(files) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var file = _step.value;\n\n          // TODO use file.path when available\n          if (!file.name) {\n            // File does not have a name when it is pasted\n            var extension = file.type === 'image/png' ? '.png' : '';\n            var newName = 'unnamed_file';\n            var counter = 1;\n            var name = newName + extension;\n            while (fileSystem.hasFile(name)) {\n              name = newName + '_' + ++counter + extension;\n            }\n            file.name = name;\n          }\n          // TODO reserve file name\n          FileReader.readAsText(file, undefined, $scope).then(function (data) {\n            if (isStringBinary(data)) {\n              fileSystem.createFile(file);\n            } else {\n              fileSystem.createFile(file.name, data, file.type);\n            }\n          }, function (err) {\n            /* eslint-disable no-console */\n            console.error(err);\n            /* eslint-enable no-console */\n          });\n        };\n\n        for (var _iterator = files[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n\n    function isStringBinary(string) {\n      /* eslint-disable no-control-regex */\n      return (/[\\x00-\\x08\\x0E-\\x1F]/.test(string)\n      );\n      /* eslint-enable no-control-regex */\n    }\n\n    function removeFile(file) {\n      var removeConfirmed = $window.confirm('Are you sure that you want to delete ' + file.name + '?');\n      if (removeConfirmed) {\n        fileSystem.deleteFile(file.name);\n      }\n    }\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo', ['ngTouch', 'ui.router', 'bsInjularLiveDemo.components.editorView']);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo').config(routerConfig);\n\n  function routerConfig($urlRouterProvider, $stateProvider) {\n    $urlRouterProvider.otherwise('/gh-gist/83f19f04eacc289cd0fc7afedd66559f');\n\n    $stateProvider.state('editor', {\n      abstract: true,\n      template: '<editor-view></editor-view>'\n    }).state('editor.blank', {\n      url: '/blank',\n      resolve: {\n        __init__: function __init__($log, projectCreator) {\n          try {\n            projectCreator.blank();\n          } catch (err) {\n            $log.error(err);\n          }\n        }\n      }\n    }).state('editor.gh-gist', {\n      url: '/gh-gist/:gistId',\n      resolve: {\n        __init__: function __init__($log, $stateParams, projectCreator) {\n          try {\n            projectCreator.githubGist($stateParams.gistId);\n          } catch (err) {\n            $log.error(err);\n          }\n        }\n      }\n    });\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo').config(config);\n\n  function config($logProvider) {\n    $logProvider.debugEnabled(location.hostname === 'localhost');\n  }\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  var mimeTypes = Object.create(null);\n  angular.extend(mimeTypes, {\n    bmp: 'image/bmp',\n    css: 'text/css',\n    gif: 'image/gif',\n    html: 'text/html',\n    ico: '  image/x-icon',\n    jpe: 'image/jpeg',\n    jpeg: 'image/jpeg',\n    jpg: 'image/jpeg',\n    js: 'application/javascript',\n    json: 'application/json',\n    png: 'image/png',\n    svg: 'image/svg+xml',\n    tiff: 'image/tiff',\n    webp: 'image/webp',\n    xml: 'application/xml'\n  });\n\n  angular.module('bsInjularLiveDemo.services.mimeType', [\n    // no dependencies\n  ]).constant('mimeType', {\n    _dict: mimeTypes,\n    lookup: lookup\n  });\n\n  function lookup(fileName) {\n    if (!fileName) return;\n    var extensionIndex = fileName.lastIndexOf('.') + 1;\n    var extension = fileName.slice(extensionIndex);\n    return this._dict[extension];\n  }\n})();\n\n\n'use strict';\n\n/* global minimatch */\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.deps.minimatch', [\n    // no dependencies\n  ]).constant('minimatch', minimatch).constant('match', match);\n\n  function match(name, pattern) {\n    if (!pattern) return false;\n    return minimatch(name, pattern);\n  }\n})();\n\n\n'use strict';\n\n/* global injular */\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.deps.injular', [\n    // no dependencies\n  ]).constant('injular', injular);\n})();\n\n\n'use strict';\n\n/* global fileChanger */\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.deps.fileChanger', [\n    // no dependencies\n  ]).constant('fileChanger', fileChanger);\n})();\n\n\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.deps.createNativeFile', [\n    // no dependencies\n  ]).constant('createNativeFile', createNativeFile);\n\n  function createNativeFile(parts, filename) {\n    var properties = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n    var file = void 0;\n    try {\n      file = new File(parts, filename, properties);\n    } catch (err) {\n      // phantomjs doesn't support FileConstructor\n      var date = void 0;\n      if ('lastModified' in properties) {\n        date = new Date(properties.lastModified);\n      } else {\n        date = new Date();\n      }\n      file = new Blob(parts, properties);\n      file.name = filename;\n      file.lastModified = +date;\n      file.lastModifiedDate = date;\n    }\n    return file;\n  }\n})();\n\n\n'use strict';\n\n/* global ace */\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.deps.ace', [\n    // no dependencies\n  ]).constant('ace', ace);\n})();\n\n\n'use strict';\n\n/* global EventEmitter */\n(function () {\n  'use strict';\n\n  angular.module('bsInjularLiveDemo.deps.EventEmitter', [\n    // no dependencies\n  ]).constant('EventEmitter', EventEmitter);\n})();\n\n\nangular.module(\"bsInjularLiveDemo\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/editorView/editorView.html\",\"<div class=editor-view ngf-drop=$ctrl.importFiles($files) ngf-multiple=true ngf-drag-over-class=\\\"\\'-dragging-file\\'\\\" ng-model-options=\\\"{updateOn: \\'drop paste\\'}\\\"><div class=topbar><button type=button class=\\\"btn-clear nav-button\\\" ng-click=\\\"$ctrl.collapsed.fileList = !$ctrl.collapsed.fileList\\\"><i class=\\\"fa fa-navicon\\\"></i></button><div class=toggle-panel-buttons><button type=button class=\\\"btn-clear editor-button\\\" ng-click=$ctrl.toggleEditorCollapse() ng-class=\\\"{\\'active\\': !$ctrl.collapsed.editor}\\\">Editor</button><!--\\n   --><button type=button class=\\\"btn-clear live-view-button\\\" ng-click=\\\"$ctrl.collapsed.liveView = !$ctrl.collapsed.liveView\\\" ng-class=\\\"{\\'active\\': !$ctrl.collapsed.liveView}\\\">Output</button><label class=hide-mode-label><span></span> <input type=checkbox ng-model=$ctrl.hideOutputMode> <span>Hide mode</span></label></div></div><div class=content ui-layout=$ctrl.uiLayout add-moving-splitbar-class ui-layout-loaded><div class=file-list-wrapper ui-layout-container collapsed=$ctrl.collapsed.fileList size=175px><ul class=file-list><li ng-repeat=\\\"file in $ctrl.editor.fileList track by file.name\\\" class=file-list-item ng-class=\\\"{\\'active\\': $ctrl.editor.activeFile === file}\\\"><button type=button class=\\\"select-file-button btn-clear\\\" ng-click=$ctrl.changeActiveFile(file) ng-dblclick=$ctrl.showRenameFilePrompt(file)>{{file.name}}</button> <button type=button class=\\\"remove-file-button btn-clear\\\" ng-click=$ctrl.removeFile(file)><i class=\\\"fa fa-remove\\\" aria-hidden=true></i></button></li><li class=file-list-item><button type=button class=\\\"file-bar-button select-file-button btn-clear\\\" ng-click=$ctrl.showNewFilePrompt()><i class=\\\"fa fa-file-code-o\\\" aria-hidden=true></i><span>New file</span></button></li></ul></div><div class=editor-wrapper ui-layout-container collapsed=$ctrl.collapsed.editor><div ace-model-manager ace-model-manager-on-load=$ctrl.aceEditorLoadListener($acee) ng-show=!$ctrl.editor.activeFile.file></div><img ng-src={{$ctrl.editor.activeFile.file|ngfDataUrl}} ng-if=$ctrl.editor.activeFile.file></div><div class=live-view-wrapper ui-layout-container collapsed=$ctrl.collapsed.liveView><div class=live-view-overlay></div><iframe id=live-view ng-if=\\\"!$ctrl.collapsed.liveView || $ctrl.hideOutputMode\\\" live-demo-iframe ng-src=about:blank></iframe></div></div></div>\");}]);",null],"sourceRoot":"/source/"}